{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "EnforceOnlyAWSServicePrincipalsAndRolesAssumedByEKSCanSetEKSSessiontTags",
      "Effect": "Deny",
      "Principal": "*",
      "Action": [
        "sts:TagSession"
      ],
      "Resource": "*",
      "Condition": {
        "ForAnyValue:StringEquals": {
          "aws:TagKeys": [
            "eks-cluster-arn",
            "eks-cluster-name",
            "kubernetes-namespace",
            "kubernetes-service-account",
            "kubernetes-pod-name",
            "kubernetes-pod-uid"
          ]
        },
        "BoolIfExists": {
          "aws:PrincipalIsAwsService": "false"
        },
        "Null": {
          "aws:PrincipalTag/eks-cluster-arn": "true",
          "aws:PrincipalTag/eks-cluster-name": "true",
          "aws:PrincipalTag/kubernetes-namespace": "true",
          "aws:PrincipalTag/kubernetes-service-account": "true",
          "aws:PrincipalTag/kubernetes-pod-name": "true",
          "aws:PrincipalTag/kubernetes-pod-uid": "true"
        }
      }
    }
  ]
}
